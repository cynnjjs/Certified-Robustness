Extracting mnist/train-images-idx3-ubyte.gz
Extracting mnist/train-labels-idx1-ubyte.gz
Extracting mnist/t10k-images-idx3-ubyte.gz
Extracting mnist/t10k-labels-idx1-ubyte.gz
Labels
[0 1 2 3 4 5 6 7 8 9]
Labels: [0 1 2 3 4 5 6 7 8 9]
Number of training examples: 60000
Number of test examples: 10000
training
Set things up with lower learning rate
Computing regularized loss
EPOCH 0
step 0, test accuracy 0.1169, regularization loss 28.9474, classification loss 3.00175
step 100, test accuracy 0.8823, regularization loss 6.03481, classification loss 0.614716
Model saved in file: pgd-epoch0-step100
step 200, test accuracy 0.88, regularization loss 4.00955, classification loss 0.700733
step 300, test accuracy 0.8832, regularization loss 3.41192, classification loss 0.665529
step 400, test accuracy 0.8695, regularization loss 3.2664, classification loss 0.647221
step 500, test accuracy 0.8958, regularization loss 3.02423, classification loss 0.56806
EPOCH 1
step 0, test accuracy 0.8987, regularization loss 3.03923, classification loss 0.605064
step 100, test accuracy 0.9093, regularization loss 2.92332, classification loss 0.56338
Model saved in file: pgd-epoch1-step100
step 200, test accuracy 0.9191, regularization loss 2.92785, classification loss 0.544439
step 300, test accuracy 0.9257, regularization loss 2.88324, classification loss 0.524894
step 400, test accuracy 0.9238, regularization loss 2.89631, classification loss 0.503874
step 500, test accuracy 0.9272, regularization loss 2.84075, classification loss 0.496828
EPOCH 2
step 0, test accuracy 0.9282, regularization loss 2.63087, classification loss 0.430291
step 100, test accuracy 0.9323, regularization loss 2.52915, classification loss 0.398927
Model saved in file: pgd-epoch2-step100
step 200, test accuracy 0.9381, regularization loss 2.52142, classification loss 0.372739
step 300, test accuracy 0.9362, regularization loss 2.46667, classification loss 0.3736
step 400, test accuracy 0.9415, regularization loss 2.47967, classification loss 0.370723
step 500, test accuracy 0.944, regularization loss 2.40756, classification loss 0.34805
EPOCH 3
step 0, test accuracy 0.945, regularization loss 2.45369, classification loss 0.326155
step 100, test accuracy 0.9472, regularization loss 2.39456, classification loss 0.330876
Model saved in file: pgd-epoch3-step100
step 200, test accuracy 0.9393, regularization loss 2.35199, classification loss 0.328499
step 300, test accuracy 0.9504, regularization loss 2.32537, classification loss 0.314686
step 400, test accuracy 0.9486, regularization loss 2.31305, classification loss 0.306216
step 500, test accuracy 0.9478, regularization loss 2.33948, classification loss 0.326119
EPOCH 4
step 0, test accuracy 0.9461, regularization loss 2.22862, classification loss 0.287471
step 100, test accuracy 0.9499, regularization loss 2.22999, classification loss 0.279734
Model saved in file: pgd-epoch4-step100
step 200, test accuracy 0.946, regularization loss 2.20873, classification loss 0.278784
step 300, test accuracy 0.9488, regularization loss 2.19085, classification loss 0.275902
step 400, test accuracy 0.9506, regularization loss 2.20012, classification loss 0.272671
step 500, test accuracy 0.9517, regularization loss 2.18901, classification loss 0.268588
EPOCH 5
step 0, test accuracy 0.9496, regularization loss 1.99118, classification loss 0.212035
step 100, test accuracy 0.9548, regularization loss 1.99925, classification loss 0.208479
Model saved in file: pgd-epoch5-step100
step 200, test accuracy 0.9517, regularization loss 1.96742, classification loss 0.214009
step 300, test accuracy 0.9473, regularization loss 1.97933, classification loss 0.208112
step 400, test accuracy 0.9543, regularization loss 1.946, classification loss 0.202
step 500, test accuracy 0.9545, regularization loss 1.98306, classification loss 0.215617
EPOCH 6
step 0, test accuracy 0.95, regularization loss 2.42123, classification loss 0.324211
step 100, test accuracy 0.9502, regularization loss 2.32264, classification loss 0.289712
Model saved in file: pgd-epoch6-step100
step 200, test accuracy 0.953, regularization loss 2.36469, classification loss 0.317618
step 300, test accuracy 0.9558, regularization loss 2.3583, classification loss 0.285042
step 400, test accuracy 0.9569, regularization loss 2.33055, classification loss 0.281869
step 500, test accuracy 0.9543, regularization loss 2.34769, classification loss 0.287479
EPOCH 7
step 0, test accuracy 0.9545, regularization loss 2.01659, classification loss 0.208322
step 100, test accuracy 0.9567, regularization loss 1.91158, classification loss 0.195587
Model saved in file: pgd-epoch7-step100
step 200, test accuracy 0.9544, regularization loss 1.95863, classification loss 0.192433
step 300, test accuracy 0.9571, regularization loss 1.92299, classification loss 0.19984
step 400, test accuracy 0.9581, regularization loss 1.95735, classification loss 0.195916
step 500, test accuracy 0.9572, regularization loss 1.92471, classification loss 0.190977
EPOCH 8
step 0, test accuracy 0.9566, regularization loss 2.08081, classification loss 0.265115
step 100, test accuracy 0.9548, regularization loss 2.01658, classification loss 0.27014
Model saved in file: pgd-epoch8-step100
step 200, test accuracy 0.9587, regularization loss 2.04274, classification loss 0.276888
step 300, test accuracy 0.9561, regularization loss 1.9982, classification loss 0.260919
step 400, test accuracy 0.9588, regularization loss 2.01245, classification loss 0.255877
step 500, test accuracy 0.9585, regularization loss 2.03608, classification loss 0.259163
EPOCH 9
step 0, test accuracy 0.9558, regularization loss 2.01356, classification loss 0.228863
step 100, test accuracy 0.9559, regularization loss 1.94612, classification loss 0.218532
Model saved in file: pgd-epoch9-step100
step 200, test accuracy 0.9568, regularization loss 1.98613, classification loss 0.235402
step 300, test accuracy 0.9585, regularization loss 1.97973, classification loss 0.224454
step 400, test accuracy 0.9578, regularization loss 1.96936, classification loss 0.237053
step 500, test accuracy 0.9554, regularization loss 1.97018, classification loss 0.232658
EPOCH 10
step 0, test accuracy 0.9579, regularization loss 2.17611, classification loss 0.257477
step 100, test accuracy 0.9586, regularization loss 2.12285, classification loss 0.245169
Model saved in file: pgd-epoch10-step100
step 200, test accuracy 0.957, regularization loss 2.14875, classification loss 0.258566
step 300, test accuracy 0.9606, regularization loss 2.10824, classification loss 0.240813
step 400, test accuracy 0.9585, regularization loss 2.13087, classification loss 0.245047
step 500, test accuracy 0.9572, regularization loss 2.07993, classification loss 0.237231
EPOCH 11
step 0, test accuracy 0.9592, regularization loss 2.10023, classification loss 0.229238
step 100, test accuracy 0.9578, regularization loss 2.14016, classification loss 0.242518
Model saved in file: pgd-epoch11-step100
step 200, test accuracy 0.9569, regularization loss 2.09904, classification loss 0.250661
step 300, test accuracy 0.9594, regularization loss 2.10444, classification loss 0.236603
step 400, test accuracy 0.9567, regularization loss 2.09182, classification loss 0.228596
step 500, test accuracy 0.9588, regularization loss 2.07076, classification loss 0.229056
EPOCH 12
step 0, test accuracy 0.9596, regularization loss 2.07086, classification loss 0.294739
step 100, test accuracy 0.9576, regularization loss 2.04829, classification loss 0.283536
Model saved in file: pgd-epoch12-step100
step 200, test accuracy 0.9602, regularization loss 2.01349, classification loss 0.27058
step 300, test accuracy 0.9605, regularization loss 1.99744, classification loss 0.280455
step 400, test accuracy 0.9605, regularization loss 2.04221, classification loss 0.276608
step 500, test accuracy 0.9601, regularization loss 1.98532, classification loss 0.275435
EPOCH 13
step 0, test accuracy 0.9602, regularization loss 2.09473, classification loss 0.229827
step 100, test accuracy 0.9606, regularization loss 2.07772, classification loss 0.227722
Model saved in file: pgd-epoch13-step100
step 200, test accuracy 0.9581, regularization loss 2.10298, classification loss 0.235215
step 300, test accuracy 0.9599, regularization loss 2.12942, classification loss 0.228507
step 400, test accuracy 0.9608, regularization loss 2.09142, classification loss 0.243323
step 500, test accuracy 0.959, regularization loss 2.0901, classification loss 0.240372
EPOCH 14
step 0, test accuracy 0.9601, regularization loss 2.02062, classification loss 0.266266
step 100, test accuracy 0.9608, regularization loss 1.984, classification loss 0.246227
Model saved in file: pgd-epoch14-step100
step 200, test accuracy 0.9587, regularization loss 2.08968, classification loss 0.288935
step 300, test accuracy 0.9597, regularization loss 2.01876, classification loss 0.260308
step 400, test accuracy 0.9607, regularization loss 2.02236, classification loss 0.261609
step 500, test accuracy 0.9596, regularization loss 2.03244, classification loss 0.24698
EPOCH 15
step 0, test accuracy 0.9619, regularization loss 2.05084, classification loss 0.240287
step 100, test accuracy 0.9623, regularization loss 2.01813, classification loss 0.224738
Model saved in file: pgd-epoch15-step100
step 200, test accuracy 0.9639, regularization loss 2.00596, classification loss 0.221229
step 300, test accuracy 0.9586, regularization loss 2.03577, classification loss 0.234547
step 400, test accuracy 0.9612, regularization loss 1.9512, classification loss 0.230194
step 500, test accuracy 0.9621, regularization loss 2.01014, classification loss 0.240583
EPOCH 16
step 0, test accuracy 0.9614, regularization loss 1.83313, classification loss 0.22287
step 100, test accuracy 0.961, regularization loss 1.85172, classification loss 0.214569
Model saved in file: pgd-epoch16-step100
step 200, test accuracy 0.963, regularization loss 1.80891, classification loss 0.209606
step 300, test accuracy 0.9618, regularization loss 1.84412, classification loss 0.208041
step 400, test accuracy 0.9624, regularization loss 1.81476, classification loss 0.222408
step 500, test accuracy 0.962, regularization loss 1.80941, classification loss 0.207877
EPOCH 17
step 0, test accuracy 0.9611, regularization loss 1.95259, classification loss 0.193303
step 100, test accuracy 0.9632, regularization loss 1.92719, classification loss 0.171571
Model saved in file: pgd-epoch17-step100
step 200, test accuracy 0.963, regularization loss 1.91468, classification loss 0.178597
step 300, test accuracy 0.9615, regularization loss 1.91264, classification loss 0.180149
step 400, test accuracy 0.9621, regularization loss 1.94492, classification loss 0.187023
step 500, test accuracy 0.9609, regularization loss 1.97509, classification loss 0.186248
EPOCH 18
step 0, test accuracy 0.9633, regularization loss 1.82341, classification loss 0.192316
step 100, test accuracy 0.9601, regularization loss 1.81406, classification loss 0.193901
Model saved in file: pgd-epoch18-step100
step 200, test accuracy 0.9615, regularization loss 1.82842, classification loss 0.19665
step 300, test accuracy 0.9606, regularization loss 1.82407, classification loss 0.209282
step 400, test accuracy 0.9626, regularization loss 1.8646, classification loss 0.196241
step 500, test accuracy 0.9615, regularization loss 1.85102, classification loss 0.199187
EPOCH 19
step 0, test accuracy 0.9616, regularization loss 1.71644, classification loss 0.150783
step 100, test accuracy 0.9625, regularization loss 1.72412, classification loss 0.155777
Model saved in file: pgd-epoch19-step100
step 200, test accuracy 0.9618, regularization loss 1.71898, classification loss 0.153216
step 300, test accuracy 0.9607, regularization loss 1.70985, classification loss 0.152495
step 400, test accuracy 0.9625, regularization loss 1.70672, classification loss 0.151947
step 500, test accuracy 0.9623, regularization loss 1.75588, classification loss 0.152827
EPOCH 20
step 0, test accuracy 0.9647, regularization loss 1.77773, classification loss 0.180622
step 100, test accuracy 0.9634, regularization loss 1.7624, classification loss 0.165311
Model saved in file: pgd-epoch20-step100
step 200, test accuracy 0.963, regularization loss 1.77606, classification loss 0.186764
step 300, test accuracy 0.9655, regularization loss 1.75269, classification loss 0.167441
step 400, test accuracy 0.9627, regularization loss 1.83672, classification loss 0.197081
step 500, test accuracy 0.9631, regularization loss 1.75147, classification loss 0.172801
EPOCH 21
step 0, test accuracy 0.9626, regularization loss 1.84703, classification loss 0.183475
step 100, test accuracy 0.9634, regularization loss 1.75889, classification loss 0.18534
Model saved in file: pgd-epoch21-step100
step 200, test accuracy 0.962, regularization loss 1.7963, classification loss 0.197025
step 300, test accuracy 0.9619, regularization loss 1.84364, classification loss 0.202112
step 400, test accuracy 0.9606, regularization loss 1.80332, classification loss 0.198165
step 500, test accuracy 0.9614, regularization loss 1.80266, classification loss 0.179219
EPOCH 22
step 0, test accuracy 0.9636, regularization loss 1.71992, classification loss 0.163024
step 100, test accuracy 0.9639, regularization loss 1.72248, classification loss 0.160098
Model saved in file: pgd-epoch22-step100
step 200, test accuracy 0.9649, regularization loss 1.71967, classification loss 0.151586
step 300, test accuracy 0.9627, regularization loss 1.68651, classification loss 0.156081
step 400, test accuracy 0.962, regularization loss 1.72093, classification loss 0.166631
step 500, test accuracy 0.9651, regularization loss 1.72137, classification loss 0.15497
EPOCH 23
step 0, test accuracy 0.9635, regularization loss 1.7744, classification loss 0.140015
step 100, test accuracy 0.9637, regularization loss 1.81934, classification loss 0.151897
Model saved in file: pgd-epoch23-step100
step 200, test accuracy 0.9636, regularization loss 1.74959, classification loss 0.142446
step 300, test accuracy 0.9628, regularization loss 1.78552, classification loss 0.145053
step 400, test accuracy 0.9634, regularization loss 1.81508, classification loss 0.149614
step 500, test accuracy 0.9641, regularization loss 1.7818, classification loss 0.143193
EPOCH 24
step 0, test accuracy 0.9653, regularization loss 1.68921, classification loss 0.147617
step 100, test accuracy 0.9609, regularization loss 1.68216, classification loss 0.135248
Model saved in file: pgd-epoch24-step100
step 200, test accuracy 0.9633, regularization loss 1.69517, classification loss 0.135487
step 300, test accuracy 0.9644, regularization loss 1.70942, classification loss 0.147862
step 400, test accuracy 0.9632, regularization loss 1.7421, classification loss 0.150721
step 500, test accuracy 0.9642, regularization loss 1.71107, classification loss 0.142864
EPOCH 25
step 0, test accuracy 0.9637, regularization loss 1.79044, classification loss 0.135267
step 100, test accuracy 0.9645, regularization loss 1.75779, classification loss 0.125431
Model saved in file: pgd-epoch25-step100
step 200, test accuracy 0.9611, regularization loss 1.8301, classification loss 0.14959
step 300, test accuracy 0.9654, regularization loss 1.87331, classification loss 0.144404
step 400, test accuracy 0.9626, regularization loss 1.77989, classification loss 0.135371
step 500, test accuracy 0.9644, regularization loss 1.80795, classification loss 0.136984
EPOCH 26
step 0, test accuracy 0.9621, regularization loss 1.68752, classification loss 0.20708
step 100, test accuracy 0.9636, regularization loss 1.65874, classification loss 0.201875
Model saved in file: pgd-epoch26-step100
step 200, test accuracy 0.9643, regularization loss 1.65769, classification loss 0.20398
step 300, test accuracy 0.9648, regularization loss 1.63934, classification loss 0.197383
step 400, test accuracy 0.9637, regularization loss 1.67714, classification loss 0.211511
step 500, test accuracy 0.9644, regularization loss 1.68684, classification loss 0.213196
EPOCH 27
step 0, test accuracy 0.9618, regularization loss 1.75421, classification loss 0.200321
step 100, test accuracy 0.9637, regularization loss 1.7342, classification loss 0.197329
Model saved in file: pgd-epoch27-step100
step 200, test accuracy 0.963, regularization loss 1.78913, classification loss 0.211481
step 300, test accuracy 0.9644, regularization loss 1.76581, classification loss 0.213223
step 400, test accuracy 0.9651, regularization loss 1.75027, classification loss 0.187036
step 500, test accuracy 0.9663, regularization loss 1.77362, classification loss 0.194856
EPOCH 28
step 0, test accuracy 0.9656, regularization loss 1.66437, classification loss 0.13167
step 100, test accuracy 0.965, regularization loss 1.67324, classification loss 0.133381
Model saved in file: pgd-epoch28-step100
step 200, test accuracy 0.965, regularization loss 1.67055, classification loss 0.142169
step 300, test accuracy 0.9669, regularization loss 1.6983, classification loss 0.142392
step 400, test accuracy 0.9627, regularization loss 1.68216, classification loss 0.147117
step 500, test accuracy 0.9662, regularization loss 1.66563, classification loss 0.142902
EPOCH 29
step 0, test accuracy 0.9653, regularization loss 1.95391, classification loss 0.222847
step 100, test accuracy 0.9665, regularization loss 1.98078, classification loss 0.23245
Model saved in file: pgd-epoch29-step100
step 200, test accuracy 0.964, regularization loss 2.02146, classification loss 0.245536
step 300, test accuracy 0.967, regularization loss 1.92417, classification loss 0.214396
step 400, test accuracy 0.9634, regularization loss 1.95358, classification loss 0.251127
step 500, test accuracy 0.9651, regularization loss 1.99416, classification loss 0.233846
EPOCH 30
step 0, test accuracy 0.9644, regularization loss 1.55646, classification loss 0.130479
step 100, test accuracy 0.9641, regularization loss 1.52978, classification loss 0.124094
Model saved in file: pgd-epoch30-step100
step 200, test accuracy 0.965, regularization loss 1.54433, classification loss 0.126943
step 300, test accuracy 0.9625, regularization loss 1.60608, classification loss 0.138337
step 400, test accuracy 0.965, regularization loss 1.53266, classification loss 0.12509
step 500, test accuracy 0.964, regularization loss 1.56205, classification loss 0.138903
EPOCH 31
step 0, test accuracy 0.9664, regularization loss 1.71113, classification loss 0.192323
step 100, test accuracy 0.9635, regularization loss 1.67389, classification loss 0.192253
Model saved in file: pgd-epoch31-step100
step 200, test accuracy 0.9611, regularization loss 1.66206, classification loss 0.183684
step 300, test accuracy 0.9658, regularization loss 1.69024, classification loss 0.189423
step 400, test accuracy 0.965, regularization loss 1.78519, classification loss 0.204719
step 500, test accuracy 0.9662, regularization loss 1.6878, classification loss 0.195697
EPOCH 32
step 0, test accuracy 0.9634, regularization loss 1.80157, classification loss 0.201342
step 100, test accuracy 0.9665, regularization loss 1.72128, classification loss 0.191347
Model saved in file: pgd-epoch32-step100
step 200, test accuracy 0.9644, regularization loss 1.77592, classification loss 0.196638
step 300, test accuracy 0.9634, regularization loss 1.79327, classification loss 0.200841
step 400, test accuracy 0.9657, regularization loss 1.77897, classification loss 0.202239
step 500, test accuracy 0.9642, regularization loss 1.77252, classification loss 0.195014
EPOCH 33
step 0, test accuracy 0.9654, regularization loss 1.4559, classification loss 0.113375
step 100, test accuracy 0.9659, regularization loss 1.45441, classification loss 0.107105
Model saved in file: pgd-epoch33-step100
step 200, test accuracy 0.9658, regularization loss 1.47662, classification loss 0.115304
step 300, test accuracy 0.9668, regularization loss 1.44209, classification loss 0.115017
step 400, test accuracy 0.9652, regularization loss 1.40779, classification loss 0.111564
step 500, test accuracy 0.965, regularization loss 1.45552, classification loss 0.121241
EPOCH 34
step 0, test accuracy 0.9649, regularization loss 1.91448, classification loss 0.184772
step 100, test accuracy 0.9662, regularization loss 1.88801, classification loss 0.187256
Model saved in file: pgd-epoch34-step100
step 200, test accuracy 0.9666, regularization loss 1.92426, classification loss 0.19398
step 300, test accuracy 0.9661, regularization loss 1.91871, classification loss 0.186768
step 400, test accuracy 0.9648, regularization loss 1.87394, classification loss 0.179341
step 500, test accuracy 0.9656, regularization loss 1.87846, classification loss 0.17811
EPOCH 35
step 0, test accuracy 0.9656, regularization loss 1.43099, classification loss 0.101228
step 100, test accuracy 0.9637, regularization loss 1.43415, classification loss 0.095551
Model saved in file: pgd-epoch35-step100
step 200, test accuracy 0.9654, regularization loss 1.48159, classification loss 0.100094
step 300, test accuracy 0.964, regularization loss 1.42892, classification loss 0.104559
step 400, test accuracy 0.9659, regularization loss 1.41201, classification loss 0.0901976
step 500, test accuracy 0.9631, regularization loss 1.40985, classification loss 0.0975118
EPOCH 36
step 0, test accuracy 0.9668, regularization loss 1.7327, classification loss 0.174487
step 100, test accuracy 0.9665, regularization loss 1.70402, classification loss 0.161218
Model saved in file: pgd-epoch36-step100
step 200, test accuracy 0.9647, regularization loss 1.73736, classification loss 0.165557
step 300, test accuracy 0.9654, regularization loss 1.66921, classification loss 0.169732
step 400, test accuracy 0.9643, regularization loss 1.74434, classification loss 0.177106
step 500, test accuracy 0.9654, regularization loss 1.67569, classification loss 0.175222
EPOCH 37
step 0, test accuracy 0.9653, regularization loss 1.86499, classification loss 0.183667
step 100, test accuracy 0.9639, regularization loss 1.82602, classification loss 0.178435
Model saved in file: pgd-epoch37-step100
step 200, test accuracy 0.9667, regularization loss 1.80871, classification loss 0.184468
step 300, test accuracy 0.9649, regularization loss 1.80436, classification loss 0.188428
step 400, test accuracy 0.9662, regularization loss 1.82996, classification loss 0.187585
step 500, test accuracy 0.9648, regularization loss 1.85277, classification loss 0.195543
EPOCH 38
step 0, test accuracy 0.9674, regularization loss 1.84501, classification loss 0.179627
step 100, test accuracy 0.9643, regularization loss 1.85873, classification loss 0.182868
Model saved in file: pgd-epoch38-step100
step 200, test accuracy 0.9656, regularization loss 1.87289, classification loss 0.183812
step 300, test accuracy 0.9629, regularization loss 1.90447, classification loss 0.19291
step 400, test accuracy 0.9652, regularization loss 1.8649, classification loss 0.1901
step 500, test accuracy 0.9662, regularization loss 1.89894, classification loss 0.188702
EPOCH 39
step 0, test accuracy 0.9636, regularization loss 1.67069, classification loss 0.155789
step 100, test accuracy 0.9659, regularization loss 1.62278, classification loss 0.153637
Model saved in file: pgd-epoch39-step100
step 200, test accuracy 0.9627, regularization loss 1.6814, classification loss 0.156345
step 300, test accuracy 0.9662, regularization loss 1.61075, classification loss 0.152538
step 400, test accuracy 0.9661, regularization loss 1.62484, classification loss 0.159457
step 500, test accuracy 0.9667, regularization loss 1.58777, classification loss 0.157722
Model saved in file: pgd-final
Weights saved in file: pgd-weights
